{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "trade-plan-v0.0.2.schema.json",
  "version": "0.0.2",
  "title": "BetterOMS Trade Plan (Phase 1)",
  "description": "Trade plan schema for Phase 1 paper trading on Polymarket with support for buy/sell and market/limit orders",
  "type": "object",
  "required": ["planId", "mode", "trades"],
  "additionalProperties": false,
  "properties": {
    "planId": {
      "type": "string",
      "minLength": 1,
      "description": "Unique identifier for this trade plan (idempotency key). Prevents duplicate execution of the same plan.",
      "examples": ["2025-09-27-1200Z", "test-001", "my-trade-plan-123"]
    },
    "mode": {
      "type": "string",
      "enum": ["paper", "live"],
      "description": "Trading mode. Phase 1 only supports 'paper' (simulated trading). Live trading will be added in Phase 3."
    },
    "trades": {
      "type": "array",
      "minItems": 1,
      "description": "Array of orders to execute in this trade plan (market or limit orders)",
      "items": {
        "type": "object",
        "required": ["marketId", "outcome", "side", "orderType", "size"],
        "additionalProperties": false,
        "allOf": [
          {
            "if": {
              "properties": {
                "orderType": { "const": "LIMIT" }
              }
            },
            "then": {
              "required": ["price"]
            }
          }
        ],
        "properties": {
          "marketId": {
            "type": "string",
            "minLength": 1,
            "description": "Polymarket market identifier (market ID or slug)",
            "examples": ["0x1234567890abcdef", "will-trump-win-2024"]
          },
          "outcome": {
            "type": "string",
            "enum": ["YES", "NO"],
            "description": "Outcome side to trade: YES or NO"
          },
          "side": {
            "type": "string",
            "enum": ["BUY", "SELL"],
            "description": "Order side: BUY to purchase shares, SELL to sell shares you own"
          },
          "orderType": {
            "type": "string",
            "enum": ["MARKET", "LIMIT"],
            "description": "Order type: MARKET executes immediately at best available price, LIMIT only executes at specified price or better"
          },
          "price": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "exclusiveMinimum": 0,
            "exclusiveMaximum": 1,
            "description": "Limit price expressed as decimal probability. Required for LIMIT orders, ignored for MARKET orders. Example: 0.42 means 42% probability (buy/sell at 42 cents per share)",
            "examples": [0.42, 0.55, 0.33]
          },
          "size": {
            "type": "number",
            "minimum": 0,
            "exclusiveMinimum": 0,
            "description": "USDC collateral amount to spend on this order. Example: 500 means spend $500 USDC",
            "examples": [100, 500, 1000]
          }
        }
      }
    }
  },
  "examples": [
    {
      "planId": "2025-09-27-1200Z",
      "mode": "paper",
      "trades": [
        {
          "marketId": "will-trump-win-2024",
          "outcome": "YES",
          "side": "BUY",
          "orderType": "LIMIT",
          "price": 0.42,
          "size": 500
        },
        {
          "marketId": "will-biden-win-2024",
          "outcome": "NO",
          "side": "BUY",
          "orderType": "MARKET",
          "size": 300
        },
        {
          "marketId": "will-harris-win-2024",
          "outcome": "YES",
          "side": "SELL",
          "orderType": "LIMIT",
          "price": 0.75,
          "size": 200
        }
      ]
    }
  ]
}
